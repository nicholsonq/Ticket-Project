<!DOCTYPE html>
<!--
Auther/Coder: Quintin Nihcolson
DateOfCeation: June 19th 2016
ProjectName: Project1 V3
Purpose: This is a simple webpage that will allow the user to submit a Ticket for an issue.
         The program will then validate the information, then upload it to a XML file on a server.
DateLastModified: 5/15/2016
NameOfModifier: Quintin Nicholson
-->



<html>
<head>
<style>
  body {background-color: lightgrey;}  <!-- Changes the Background to light grey -->
</style>

  <center><img src="https://www.csra.com/sites/all/themes/sra/logo.png" alt="CSRA Logo"></center>
  <title>Data Center Support Operations</title>
  <h1 style="text-align:center;">Submit a Ticket </h1>

</head>
<body>

<form style="text-align:center;" name="myForm" action="Ticket.php" method="post">

<!-- CUSTOMER ID NUMBER -->
  <b>Customer ID Number:</b><br>
  <input type="text" name="customerid"><br><br>

<!-- FIRST NAME -->
  <b>First name:</b><br>
  <input type="text" name="firstname"
   pattern="[a-zA-Z]{1,20}" title="First Name (Letters Only)"><br><br>

<!-- LAST NAME -->
  <b>Last name:</b><br>
  <input type="text" name="lastname"
   pattern="[a-zA-Z]{1,20}" title="Last Name (Letters Only)"><br><br>

<!-- EMAIL ADDRESS -->
  <b>Email Address:</b><br>
  <input type="email" name="email"><br><br>

<!-- CONTACT PHONE NUMBER (DAY) -->
  <b>
    Contact Phone Number (Day):
  </b><br>
  <input type="tel" name="daytel" pattern="[0-9]{10}" title="Contact number to call during the day. (3045551234)">
  <br><br>

<!-- CONTACT PHONE NUMBER (EVENING) -->
  <b>
    Contact Phone Number (Evening):
  </b><br>
  <input type="tel" name="nighttel" pattern="[0-9]{10}" title="Contact number to call after business hours. (3045551234)">
  <br><br>

<!-- DATE ISSUE STARTED -->
  <b>
    <a data-toggle="tooltip" title="The date the issue started">Date Issue Started:</a>
  </b><br>
  <input type="date" name="issuedate">
  <br><br>

<!-- DESCRIPTION OF ISSUE -->
  <b>Description Of Issue:</b><br>
  <textarea name="description" rows="5" cols="40"></textarea><br><br>

<!-- IP ADRESS OR DOMAIN -->
  <b>IP Address Or Domain Name:</b><br>
  <input type="text" name="ipdomain"><br><br>

<!-- CRITICALITY OF ISSUE -->
  <b>
    <a data-toggle="tooltip" title="How severe the issue is">Criticality Of Issue:</a>
  </b><br>
  <input type="radio" name="criticality" value="low"> Low
  <input type="radio" name="criticality" value="moderate"> Moderate
  <input type="radio" name="criticality" value="high"> High <br><br>

<!-- SUBMIT BUTTON -->
  <input type="button" value="Submit" onclick="validate()">

</form>



<!-- *****JAVASCRIPT***** -->
<script>
  function validate()
  {
    var a = document.forms["myForm"]["firstname"].value;
    var b = document.forms["myForm"]["lastname"].value;
    var c = document.forms["myForm"]["daytel"].value;
    var d = document.forms["myForm"]["nighttel"].value;

    if(a == "" || a == null)   <!-- Makes sure First Name is not empty -->
         {
            alert( "Please provide your First Name!" );
            document.myForm.firstname.focus();
            return false;
         }
    if(b == "" || b == null)   <!-- Makes sure Last Name is not empty -->
         {
            alert( "Please provide your Last Name!" );
            document.myForm.lastname.focus();
            return false;
         }
    if(c == "" || c == null)   <!-- Makes sure Day Phone is not empty -->
         {
            alert( "Please provide your Day Time Phone Number!" );
            document.myForm.daytel.focus();
            return false;
         }
    if(d == "" || d == null)   <!-- Makes sure Night Phone is not empty -->
         {
            alert( "Please provide your Night Time Phone Number!" );
            document.myForm.nighttel.focus();
            return false;
         }

    alert( "Ticket Submitted!" );
    loadXML();
    return true;
  } <!-- End Validate() -->


  function loadXML()
  {
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.open("POST", "Ticket.xml", true);
    xmlhttp.send();

    xmlDoc = xmlhttp.responseXML;
    xmlhttp.onreadystatechange = function()
    {
      if(xmlhttp.readyState == 4 && xmlhttp.status == 200)
      {
        xmlDoc.getElementsByTagName("CustomerID")[0].childNodes[0].nodeValue = document.getElementById("customerid").value;
        xmlDoc.getElementsByTagName("FirstName")[0].childNodes[0].nodeValue = document.getElementById("firstname").value;
        xmlDoc.getElementsByTagName("LastName")[0].childNodes[0].nodeValue = document.getElementById("lastname").value;
        xmlDoc.getElementsByTagName("Email")[0].childNodes[0].nodeValue = document.getElementById("email").value;
        xmlDoc.getElementsByTagName("ContactDayNum")[0].childNodes[0].nodeValue = document.getElementById("daytel").value;
        xmlDoc.getElementsByTagName("ContactNightNum")[0].childNodes[0].nodeValue = document.getElementById("nighttel").value;
        xmlDoc.getElementsByTagName("IssueStartDate")[0].childNodes[0].nodeValue = document.getElementById("issuedate").value;
        xmlDoc.getElementsByTagName("DescriptionOfIssue")[0].childNodes[0].nodeValue = document.getElementById("description").value;
        xmlDoc.getElementsByTagName("IPAddressOrDomain")[0].childNodes[0].nodeValue = document.getElementById("ipdomain").value;
        xmlDoc.getElementsByTagName("CriticalityOfIssue")[0].childNodes[0].nodeValue = document.getElementById("criticality").value;
        xmlDoc.save();


      }<!-- End if() -->
    } <!-- End function() -->
  } <!-- End loadXML() -->

</script>

</body>
</html>
